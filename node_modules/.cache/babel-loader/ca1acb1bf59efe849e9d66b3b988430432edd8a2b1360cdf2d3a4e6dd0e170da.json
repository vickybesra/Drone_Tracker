{"ast":null,"code":"var _jsxFileName = \"/Users/vickybesra/Documents/Enhanced_Projects/BTP_project/tractor-tracker-backend/src/components/VehicleTracker.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet';\nimport L from 'leaflet';\nimport io from 'socket.io-client';\nimport 'leaflet/dist/leaflet.css';\n\n// Vehicle styles remain the same as in your original code\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst vehicleStyles = {\n  vehicle1: {\n    icon: L.icon({\n      iconUrl: '/tractor_2548747.png',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32]\n    }),\n    pathColor: 'blue'\n  },\n  vehicle2: {\n    icon: L.icon({\n      iconUrl: '/vecteezy_tractor-png-with-ai-generated_26773255.png',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32]\n    }),\n    pathColor: 'red'\n  },\n  vehicle3: {\n    icon: L.icon({\n      iconUrl: '/vecteezy_construction-vehicle-3d-render-clipart_31614137.png',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32]\n    }),\n    pathColor: 'green'\n  }\n};\nconst defaultStyle = {\n  icon: L.icon({\n    iconUrl: '/vecteezy_tractor-png-with-ai-generated_26773255.png',\n    iconSize: [32, 32],\n    iconAnchor: [16, 32],\n    popupAnchor: [0, -32]\n  }),\n  pathColor: 'gray'\n};\nfunction VehicleTracker() {\n  _s();\n  const [vehicles, setVehicles] = useState({});\n  const [trackedPaths, setTrackedPaths] = useState({});\n\n  // Max number of historical positions to keep\n  const MAX_POSITIONS = 500;\n  const updateVehiclePosition = useCallback(data => {\n    setVehicles(prevVehicles => {\n      const newVehicles = {\n        ...prevVehicles\n      };\n\n      // Ensure vehicle exists\n      if (!newVehicles[data.id]) {\n        newVehicles[data.id] = {\n          id: data.id,\n          currentPosition: null,\n          lastUpdateTime: null\n        };\n      }\n\n      // Update current position\n      newVehicles[data.id].currentPosition = {\n        lat: data.latitude,\n        lng: data.longitude\n      };\n      newVehicles[data.id].lastUpdateTime = Date.now();\n      return newVehicles;\n    });\n\n    // Update tracked paths\n    setTrackedPaths(prevPaths => {\n      const newPaths = {\n        ...prevPaths\n      };\n\n      // Initialize path for vehicle if not exists\n      if (!newPaths[data.id]) {\n        newPaths[data.id] = [];\n      }\n\n      // Add new position\n      newPaths[data.id].push({\n        lat: data.latitude,\n        lng: data.longitude,\n        timestamp: Date.now()\n      });\n\n      // Limit positions to prevent memory overflow\n      if (newPaths[data.id].length > MAX_POSITIONS) {\n        newPaths[data.id].shift();\n      }\n      return newPaths;\n    });\n  }, []);\n  useEffect(() => {\n    // Create socket connection\n    const socket = io('http://localhost:8080');\n\n    // Listen for vehicle position updates\n    socket.on('vehicle-position-update', updateVehiclePosition);\n\n    // Cleanup function\n    return () => {\n      socket.disconnect();\n    };\n  }, [updateVehiclePosition]);\n  return /*#__PURE__*/_jsxDEV(MapContainer, {\n    center: [22.346010, 87.315221],\n    zoom: 13,\n    style: {\n      height: '500px',\n      width: '100%'\n    },\n    children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n      url: \"https://tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this), Object.keys(vehicles).map(id => {\n      const vehicle = vehicles[id];\n      const path = trackedPaths[id] || [];\n      const style = vehicleStyles[id] || defaultStyle;\n\n      // Convert positions to array for Polyline\n      const positions = path.map(pos => [pos.lat, pos.lng]);\n      return /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: [positions.length > 1 && /*#__PURE__*/_jsxDEV(Polyline, {\n          positions: positions,\n          color: style.pathColor,\n          weight: 3\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 15\n        }, this), vehicle.currentPosition && /*#__PURE__*/_jsxDEV(Marker, {\n          position: [vehicle.currentPosition.lat, vehicle.currentPosition.lng],\n          icon: style.icon,\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: [\"Vehicle \", id, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 31\n            }, this), \"Last Update: \", new Date(vehicle.lastUpdateTime).toLocaleString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 15\n        }, this)]\n      }, id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this);\n    })]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 5\n  }, this);\n}\n_s(VehicleTracker, \"Wa9RVQhnPkagv3o+NiKC0VFSako=\");\n_c = VehicleTracker;\nexport default VehicleTracker;\nvar _c;\n$RefreshReg$(_c, \"VehicleTracker\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","MapContainer","TileLayer","Marker","Popup","Polyline","L","io","jsxDEV","_jsxDEV","vehicleStyles","vehicle1","icon","iconUrl","iconSize","iconAnchor","popupAnchor","pathColor","vehicle2","vehicle3","defaultStyle","VehicleTracker","_s","vehicles","setVehicles","trackedPaths","setTrackedPaths","MAX_POSITIONS","updateVehiclePosition","data","prevVehicles","newVehicles","id","currentPosition","lastUpdateTime","lat","latitude","lng","longitude","Date","now","prevPaths","newPaths","push","timestamp","length","shift","socket","on","disconnect","center","zoom","style","height","width","children","url","attribution","fileName","_jsxFileName","lineNumber","columnNumber","Object","keys","map","vehicle","path","positions","pos","Fragment","color","weight","position","toLocaleString","_c","$RefreshReg$"],"sources":["/Users/vickybesra/Documents/Enhanced_Projects/BTP_project/tractor-tracker-backend/src/components/VehicleTracker.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet';\nimport L from 'leaflet';\nimport io from 'socket.io-client';\nimport 'leaflet/dist/leaflet.css';\n\n// Vehicle styles remain the same as in your original code\nconst vehicleStyles = {\n  vehicle1: { \n    icon: L.icon({\n      iconUrl: '/tractor_2548747.png',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32]\n    }),\n    pathColor: 'blue'\n  },\n  vehicle2: { \n    icon: L.icon({\n      iconUrl: '/vecteezy_tractor-png-with-ai-generated_26773255.png',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32]\n    }),\n    pathColor: 'red'\n  },\n  vehicle3: { \n    icon: L.icon({\n      iconUrl: '/vecteezy_construction-vehicle-3d-render-clipart_31614137.png',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32]\n    }),\n    pathColor: 'green'\n  }\n};\n\nconst defaultStyle = {\n  icon: L.icon({\n    iconUrl: '/vecteezy_tractor-png-with-ai-generated_26773255.png',\n    iconSize: [32, 32],\n    iconAnchor: [16, 32],\n    popupAnchor: [0, -32]\n  }),\n  pathColor: 'gray'\n};\n\nfunction VehicleTracker() {\n  const [vehicles, setVehicles] = useState({});\n  const [trackedPaths, setTrackedPaths] = useState({});\n\n  // Max number of historical positions to keep\n  const MAX_POSITIONS = 500;\n\n  const updateVehiclePosition = useCallback((data) => {\n    setVehicles(prevVehicles => {\n      const newVehicles = { ...prevVehicles };\n      \n      // Ensure vehicle exists\n      if (!newVehicles[data.id]) {\n        newVehicles[data.id] = {\n          id: data.id,\n          currentPosition: null,\n          lastUpdateTime: null\n        };\n      }\n      \n      // Update current position\n      newVehicles[data.id].currentPosition = { \n        lat: data.latitude, \n        lng: data.longitude \n      };\n      newVehicles[data.id].lastUpdateTime = Date.now();\n      \n      return newVehicles;\n    });\n\n    // Update tracked paths\n    setTrackedPaths(prevPaths => {\n      const newPaths = { ...prevPaths };\n      \n      // Initialize path for vehicle if not exists\n      if (!newPaths[data.id]) {\n        newPaths[data.id] = [];\n      }\n      \n      // Add new position\n      newPaths[data.id].push({ \n        lat: data.latitude, \n        lng: data.longitude,\n        timestamp: Date.now()\n      });\n      \n      // Limit positions to prevent memory overflow\n      if (newPaths[data.id].length > MAX_POSITIONS) {\n        newPaths[data.id].shift();\n      }\n      \n      return newPaths;\n    });\n  }, []);\n\n  useEffect(() => {\n    // Create socket connection\n    const socket = io('http://localhost:8080');\n  \n    // Listen for vehicle position updates\n    socket.on('vehicle-position-update', updateVehiclePosition);\n  \n    // Cleanup function\n    return () => {\n      socket.disconnect();\n    };\n  }, [updateVehiclePosition]); \n\n  return (\n    <MapContainer \n      center={[22.346010, 87.315221]} \n      zoom={13} \n      style={{ height: '500px', width: '100%' }}\n    >\n      <TileLayer\n        url=\"https://tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n      />\n      {Object.keys(vehicles).map(id => {\n        const vehicle = vehicles[id];\n        const path = trackedPaths[id] || [];\n        const style = vehicleStyles[id] || defaultStyle;\n        \n        // Convert positions to array for Polyline\n        const positions = path.map(pos => [pos.lat, pos.lng]);\n\n        return (\n          <React.Fragment key={id}>\n            {positions.length > 1 && (\n              <Polyline \n                positions={positions} \n                color={style.pathColor} \n                weight={3}\n              />\n            )}\n            {vehicle.currentPosition && (\n              <Marker \n                position={[\n                  vehicle.currentPosition.lat, \n                  vehicle.currentPosition.lng\n                ]} \n                icon={style.icon}\n              >\n                <Popup>\n                  Vehicle {id}<br/>\n                  Last Update: {new Date(vehicle.lastUpdateTime).toLocaleString()}\n                </Popup>\n              </Marker>\n            )}\n          </React.Fragment>\n        );\n      })}\n    </MapContainer>\n  );\n}\n\nexport default VehicleTracker;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}